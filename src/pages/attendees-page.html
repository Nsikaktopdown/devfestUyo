<link rel="import" href="../../bower_components/polymer/polymer-element.html">

<link rel="import" href="../../bower_components/app-route/app-route.html">
<link rel="import" href="../../bower_components/plastic-image/plastic-image.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../../bower_components/paper-progress/paper-progress.html">

<link rel="import" href="../mixins/utils-functions.html">
<link rel="import" href="../mixins/redux-mixin.html">
<link rel="import" href="../elements/text-truncate.html">
<link rel="import" href="../mixins/attendees-hoc.html">
<link rel="import" href="../elements/shared-styles.html">
<link rel="import" href="../elements/content-loader.html">

<dom-module id="attendees-page">
  <template>
    <style is="custom-style" include="shared-styles flex flex-alignment positioning"></style>

    <style>
      :host {
        display: block;
        height: 100%;
      }

      .container {
        display: grid;
        grid-template-columns: 1fr;
        grid-gap: 16px;
        min-height: 80%;
      }

      .attendee {
        padding: 32px 24px;
        background: var(--primary-background-color);
        text-align: center;
        transition: box-shadow var(--animation);
      }

      .attendee:hover {
        box-shadow: var(--box-shadow);
      }

      .photo {
        width: 128px;
        height: 128px;
        background-color: var(--secondary-background-color);
        border-radius: 50%;
        overflow: hidden;
        transform: translateZ(0);
      }

      .badges {
        position: absolute;
        top: 0;
        left: calc(50% + 32px);
      }

      .badge {
        margin-left: -10px;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        border: 2px solid #fff;
        transition: transform var(--animation);
      }

      .badge:hover {
        transform: scale(1.1);
      }

      .badge:nth-of-type(2) {
        transform: translate(25%, 75%);
      }

      .badge:nth-of-type(2):hover {
        transform: translate3d(25%, 75%, 20px) scale(1.1);
      }

      .badge-icon {
        --iron-icon-width: 12px;
        --iron-icon-height: 12px;
        color: #fff;
      }

      .company-logo {
        width: 100%;
        height: 16px;
      }

      .description {
        color: var(--primary-text-color);
      }

      .name {
        margin-top: 8px;
        line-height: 1;
      }

      .origin {
        margin-top: 4px;
        font-size: 14px;
        line-height: 1.1;
      }

      .bio {
        margin-top: 16px;
        color: var(--secondary-text-color);
      }

      .contacts {
        margin-top: 16px;
      }

      .social-icon {
        --paper-icon-button: {
          padding: 6px;
          width: 32px;
          height: 32px;
        }

        ;
        color: var(--secondary-text-color);
      }

      paper-progress {
        width: 100%;
        --paper-progress-active-color: var(--default-primary-color);
        --paper-progress-secondary-color: var(--default-primary-color);
      }

      @media (min-width: 640px) {
        .container {
          grid-template-columns: repeat(2, 1fr);
        }
      }

      @media (min-width: 812px) {
        .container {
          grid-template-columns: repeat(3, 1fr);
        }
      }

      @media (min-width: 1024px) {
        .container {
          grid-template-columns: repeat(4, 1fr);
        }
      }
    </style>

    <polymer-helmet title="attendees | GDG DevFest Ukraine" description="Learn more about attendees" active="[[_setHelmetData(active, isDialogOpened)]]"></polymer-helmet>

    <!-- <app-route route="[[route]]" pattern="/:attendeeId" data="{{routeData}}"></app-route> -->

    <hero-block background-image="{$ heroSettings.attendees.background.image $}" background-color="{$ heroSettings.attendees.background.color $}"
      font-color="{$ heroSettings.attendees.fontColor $}" active="[[active]]">
      <div class="hero-title highlight-font">{$ heroSettings.attendees.title $}</div>
      <p class="hero-description">{$ heroSettings.attendees.description $}</p>
    </hero-block>

    <paper-progress indeterminate hidden$="[[contentLoaderVisibility]]"></paper-progress>

    <content-loader class="container" card-padding="32px" card-height="400px" avatar-size="128px" avatar-circle="64px"
      horizontal-position="50%" box-shadow="var(--box-shadow)" items-count="{$ contentLoaders.attendees.itemsCount $}"
      hidden$="[[contentLoaderVisibility]]"></content-loader>

    <div class="container">
      <template is="dom-repeat" items="[[attendees]]" as="attendee">
          <div relative>
            <plastic-image class="photo" srcset="[[attendee.photoUrl]]" sizing="cover" lazy-load preload fade></plastic-image>
            <div class="badges" layout horizontal>
              <template is="dom-repeat" items="[[attendee.badges]]" as="badge">
                <a class$="badge [[badge.name]]-b" href$="[[badge.link]]" target="_blank" rel="noopener noreferrer"
                  title$="[[badge.description]]" layout horizontal center-center>
                  <iron-icon class="badge-icon" icon="hoverboard:[[badge.name]]"></iron-icon>
                </a>
              </template>
            </div>
          </div>

          <plastic-image class="company-logo" srcset="[[attendee.companyLogoUrl]]" sizing="contain" lazy-load preload
            fade></plastic-image>

          <div class="description">
            <h2 class="name">[[attendee.name]]</h2>
            <div class="origin">[[attendee.country]]</div>
          </div>
      </template>
    </div>

    <footer-block></footer-block>

  </template>

  <script>
    // eslint-disable-next-line no-undef
class AttendeesPage extends ReduxMixin(Polymer.Element) {
      static get is() {
        return 'attendees-page';
      }

      static get properties() {
        return {
          attendees: {
            type: Array,
            statePath: 'attendees.list',
          },
          attendeesMap: {
            type: Object,
            statePath: 'attendees.obj',
          },
          attendeesFetching: {
            type: Boolean,
            statePath: 'attendees.fetching',
          },
          attendeesFetchingError: {
            type: Object,
            statePath: 'attendees.fetchingError',
          },
          active: Boolean,
          contentLoaderVisibility: {
            type: String,
            value: null,
          },
        };
      }

        connectedCallback() {
          super.connectedCallback();
          if (!this.teamFetching && (!this.team || !this.team.length)) {
            this.dispatch(teamActions.fetchTeam());
          }
        }

    }

    window.customElements.define(AttendeesPage.is, AttendeesPage);
  </script>
</dom-module>
